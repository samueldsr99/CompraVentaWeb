@using CompraVenta.ViewModels;
@using Microsoft.AspNetCore.Identity;
@inject SignInManager<Account> SignInManager
@model AnnounceViewModel
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="wrapper-main">
    <!-- full Title -->
    <div class="full-title">
        <div class="container">
            <!-- Page Heading/Breadcrumbs -->
            <h1 class="mt-4 mb-3"> Anuncio </h1>
            <div class="breadcrumb-main">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item">
                    </li>
                </ol>
            </div>
        </div>
    </div>

    <div class="blog-main">
        <div class="container">
            <div class="row">
                <!-- Post Content Column -->
                <div class="col-lg-8">
                    <!-- Title -->
                    <h1 class="text-center">@Model.Title</h1>
                    <h3 class="text-left text-secondary">Categoría: @Model.Category.</h3>
                    <h5 class="text-center">por <a asp-action="AccountDetails" asp-controller="Account" asp-route-userName="@Model.SellerUserName">@Model.SellerUserName</a></h5>
                    <!-- Preview Image Not implemented yet! -->
                    <img class="img-fluid rounded" src="~/images/laptop.bmp" alt="" />
                    <hr>
                    <!-- Date/Time -->
                    <p class="text-black-50">Publicado el @Model.Date</p>
                    <hr>
                    <h3 class="text-left">Precio: $@Model.Price</h3>
                    <!-- Post Content -->
                    <h2 class="text-center">Detalles:</h2>
                    <h4 class="my-4 text-black-50 text-center">
                        @{
                            int p = 0;
                            while (p < Model.Description.Length)
                            {
                                @Model.Description.Substring(p, Math.Min(80, Model.Description.Length - p))
                                p += 80;
                                <br />
                            }
                        }
                    </h4>

                    @if (SignInManager.IsSignedIn(User))
                    {
                        <button class="btn btn-primary">Comprar</button>

                        <div class="blog-right-side">
                            <!-- Comments Form -->
                            <div class="card my-4">
                                <h5 class="card-header">Leave a Comment:</h5>
                                <div class="card-body">
                                    <form method="post">
                                        <div asp-validation-summary="All" class="text-danger"></div>
                                        <div class="form-group">
                                            <textarea asp-for="CommentFormDescription" class="form-control" rows="3"></textarea>
                                        </div>
                                        <button type="submit" class="btn btn-primary">Submit</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    }

                    @foreach (var comment in Model.Comments)
                    {
                        <div class="media mb-4">
                            <img class="d-flex mr-3 rounded-circle" src="images/testi_03.png" alt="">
                            <div class="media-body">
                                <h5 class="mt-0"><a asp-action="AccountDetails" asp-controller="Account" asp-route-userName="@comment.UserId">@comment.UserId</a></h5>
                                <p>@comment.Description</p>
                                Publicado el @comment.PubDate
                                <hr />
                            </div>
                        </div>
                    }

                </div>
            </div>
            <!-- /.row -->
        </div>
        <!-- /.container -->
    </div>
</div>
